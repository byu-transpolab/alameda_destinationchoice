<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 3 Methodology | Estimating Park Choice and Access in Alameda County, California, using Passive Origin-Destination Data.</title>
  <meta name="description" content="Alameda Park Choice" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content=" 3 Methodology | Estimating Park Choice and Access in Alameda County, California, using Passive Origin-Destination Data." />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Alameda Park Choice" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 3 Methodology | Estimating Park Choice and Access in Alameda County, California, using Passive Origin-Destination Data." />
  
  <meta name="twitter:description" content="Alameda Park Choice" />
  



<meta name="date" content="2020-10-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="literature.html"/>
<link rel="next" href="applications.html"/>
<style type="text/css">
p.abstract{
  text-align: center;
  font-weight: bold;
}
div.abstract{
  margin: auto;
  width: 90%;
}
</style>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Alameda Park Choice</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="literature.html"><a href="literature.html"><i class="fa fa-check"></i><b>2</b> Literature</a><ul>
<li class="chapter" data-level="2.1" data-path="literature.html"><a href="literature.html#passive-location-data"><i class="fa fa-check"></i><b>2.1</b> Passive Location Data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="methodology.html"><a href="methodology.html"><i class="fa fa-check"></i><b>3</b> Methodology</a><ul>
<li class="chapter" data-level="3.1" data-path="methodology.html"><a href="methodology.html#data"><i class="fa fa-check"></i><b>3.1</b> Data</a></li>
<li class="chapter" data-level="3.2" data-path="methodology.html"><a href="methodology.html#model"><i class="fa fa-check"></i><b>3.2</b> Model</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>4</b> Applications</a><ul>
<li class="chapter" data-level="4.1" data-path="applications.html"><a href="applications.html#example-one"><i class="fa fa-check"></i><b>4.1</b> Example one</a></li>
<li class="chapter" data-level="4.2" data-path="applications.html"><a href="applications.html#example-two"><i class="fa fa-check"></i><b>4.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>5</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estimating Park Choice and Access in Alameda County, California, using Passive Origin-Destination Data.</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="methodology" class="section level1">
<h1><span class="header-section-number"> 3</span> Methodology</h1>
<p>We constructed a dataset on which to estimate park activity location choices for
a sample of observed trips in Alameda County, California. Alameda County is one
of the seven counties that constitutes the San Francisco Bay Area metropolitan
region in California. Alameda is the seventh most populous county in California
with a population of 1.5 million <span class="citation">(U.S. Census Bureau <a href="#ref-alamedafacts" role="doc-biblioref">2019</a>)</span>, and has 14 incorporated cities
and several unincorporated communities. It is an economically and ethnically
diverse county and hence it was an attractive area to use for this study. The
racial makeup of Alameda County was (49.7%) White, (11.2%) African American,
(1.0%) Native American, (38.7%) Asian, (1.0%) Pacific Islander, and (22.4%
Hispanic or Latino (of any race). Alameda County has a diverse set of parks,
ranging from local small community parks, urban and transit-accessible parks
like the Lake Merritt Recreational area, accessible coastal access, and suburban
recreational areas like Lake Chabot.</p>
<div id="data" class="section level2">
<h2><span class="header-section-number">3.1</span> Data</h2>
<p>We constructed an analysis dataset from a publicly-available parks polygons
layer, a commercially acquired passive device origin-destination table
representing trips between the parks and home block groups, and American
Community Survey data for the home block groups.</p>
<p>We obtained a polygons shapefile layer representing open spaces in Alameda
County, California from the California Protected Areas Database <span class="citation">(GreenInfo Network <a href="#ref-cpad2019" role="doc-biblioref">2019</a>)</span>.
This dataset was selected because it included multiple different types of open
space including local and state parks, traditional green spaces as well as
wildlife refuges and other facilities that can be used for recreation. We
removed facilities that did not allow open access to the public (such as the
Oakland Zoo) and facilities whose boundaries conflated with freeway right-of-way
– this prevents trips through the park from being conflated with park trips in
the passive origin-destination data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="methodology.html#cb1-1"></a>not_parks &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;3455&quot;</span>, <span class="st">&quot;15886&quot;</span>, <span class="st">&quot;13243&quot;</span>)</span>
<span id="cb1-2"><a href="methodology.html#cb1-2"></a>parks &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="kw">here</span>(<span class="st">&quot;data/bayarea_parks.geojson&quot;</span>), <span class="dt">quiet =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb1-3"><a href="methodology.html#cb1-3"></a><span class="st">  </span><span class="kw">filter</span>(COUNTY <span class="op">==</span><span class="st"> &quot;Alameda&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb1-4"><a href="methodology.html#cb1-4"></a><span class="st">  </span><span class="kw">transmute</span>(</span>
<span id="cb1-5"><a href="methodology.html#cb1-5"></a>    <span class="dt">id =</span> <span class="kw">as.character</span>(UNIT_ID), <span class="dt">name =</span> UNIT_NAME, </span>
<span id="cb1-6"><a href="methodology.html#cb1-6"></a>    <span class="dt">access =</span> <span class="kw">factor</span>(ACCESS_TYP, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Open Access&quot;</span>, <span class="st">&quot;No Public Access&quot;</span>, </span>
<span id="cb1-7"><a href="methodology.html#cb1-7"></a>                                           <span class="st">&quot;Restricted Access&quot;</span>)),</span>
<span id="cb1-8"><a href="methodology.html#cb1-8"></a>    <span class="dt">acres =</span> ACRES, <span class="dt">type =</span> DES_TP) <span class="op">%&gt;%</span></span>
<span id="cb1-9"><a href="methodology.html#cb1-9"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>id <span class="op">%in%</span><span class="st"> </span>not_parks) <span class="op">%&gt;%</span></span>
<span id="cb1-10"><a href="methodology.html#cb1-10"></a><span class="st">  </span><span class="kw">filter</span>(access <span class="op">==</span><span class="st"> &quot;Open Access&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb1-11"><a href="methodology.html#cb1-11"></a><span class="st">  </span><span class="kw">select</span>(id, access, acres, type)  <span class="op">%&gt;%</span></span>
<span id="cb1-12"><a href="methodology.html#cb1-12"></a><span class="st">  </span><span class="kw">st_transform</span>(this_crs)</span></code></pre></div>
<p>From this initial parks polygons dataset, we obtained park attribute information
through OpenStreetMap (OSM) using the <code>osmdata</code> package for R <span class="citation">(Padgham et al. <a href="#ref-osmdata" role="doc-biblioref">2017</a>)</span>. Three
attribute elements are considered in this analysis. First, we identify playgrounds
using OSM facilities given a <code>leisure = playground</code> tag.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="methodology.html#cb2-1"></a>playground_osm &lt;-<span class="st"> </span><span class="kw">opq</span>(bb) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># specify boundary for query</span></span>
<span id="cb2-2"><a href="methodology.html#cb2-2"></a><span class="st">  </span><span class="kw">add_osm_feature</span>(<span class="dt">key =</span> <span class="st">&quot;leisure&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;playground&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># specify which kinds of data we want</span></span>
<span id="cb2-3"><a href="methodology.html#cb2-3"></a><span class="st">  </span><span class="kw">osmdata_sf</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># get a list of sf data frames for these tags</span></span>
<span id="cb2-4"><a href="methodology.html#cb2-4"></a><span class="st">  </span><span class="kw">trim_osmdata</span>(bb, <span class="dt">exclude =</span> <span class="ot">TRUE</span>)</span>
<span id="cb2-5"><a href="methodology.html#cb2-5"></a></span>
<span id="cb2-6"><a href="methodology.html#cb2-6"></a>playgrounds &lt;-<span class="st"> </span><span class="kw">rbind</span>(</span>
<span id="cb2-7"><a href="methodology.html#cb2-7"></a>  <span class="co"># convert polygons to centroids</span></span>
<span id="cb2-8"><a href="methodology.html#cb2-8"></a>  playground_osm<span class="op">$</span>osm_polygons <span class="op">%&gt;%</span></span>
<span id="cb2-9"><a href="methodology.html#cb2-9"></a><span class="st">    </span><span class="kw">st_transform</span>(this_crs) <span class="op">%&gt;%</span></span>
<span id="cb2-10"><a href="methodology.html#cb2-10"></a><span class="st">    </span><span class="kw">st_centroid</span>() <span class="op">%&gt;%</span></span>
<span id="cb2-11"><a href="methodology.html#cb2-11"></a><span class="st">    </span><span class="kw">select</span>(osm_id),</span>
<span id="cb2-12"><a href="methodology.html#cb2-12"></a>  <span class="co"># get points</span></span>
<span id="cb2-13"><a href="methodology.html#cb2-13"></a>  playground_osm<span class="op">$</span>osm_points <span class="op">%&gt;%</span></span>
<span id="cb2-14"><a href="methodology.html#cb2-14"></a><span class="st">    </span><span class="kw">st_transform</span>(this_crs) <span class="op">%&gt;%</span></span>
<span id="cb2-15"><a href="methodology.html#cb2-15"></a><span class="st">    </span><span class="kw">select</span>(osm_id)</span>
<span id="cb2-16"><a href="methodology.html#cb2-16"></a>  <span class="co"># no multipolygons or polylines that need to be included</span></span>
<span id="cb2-17"><a href="methodology.html#cb2-17"></a>) <span class="op">%&gt;%</span></span>
<span id="cb2-18"><a href="methodology.html#cb2-18"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">playground =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>Second, we consider sport fields of various kinds identified with the OSM
<code>leisure = pitch</code> tag. This tag has an additional attribute describing the sport
the field is designed for, which we retain in a consolidated manner. Soccer and
American football fields are considered in a single category, and baseball and
softball fields are combined as well. Basketball, tennis, and volleyball courts
are kept as distinct categories, with all other sport-specific fields combined
into a single “other”. Golf courses are discarded.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="methodology.html#cb3-1"></a>pitches_osm &lt;-<span class="st"> </span><span class="kw">opq</span>(bb) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># specify boundary for query</span></span>
<span id="cb3-2"><a href="methodology.html#cb3-2"></a><span class="st">  </span><span class="kw">add_osm_feature</span>(<span class="dt">key =</span> <span class="st">&quot;leisure&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;pitch&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-3"><a href="methodology.html#cb3-3"></a><span class="st">  </span><span class="kw">osmdata_sf</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-4"><a href="methodology.html#cb3-4"></a><span class="st">  </span><span class="kw">trim_osmdata</span>(bb, <span class="dt">exclude =</span> <span class="ot">TRUE</span>)</span>
<span id="cb3-5"><a href="methodology.html#cb3-5"></a></span>
<span id="cb3-6"><a href="methodology.html#cb3-6"></a>pitches &lt;-<span class="st"> </span><span class="kw">rbind</span>(</span>
<span id="cb3-7"><a href="methodology.html#cb3-7"></a>  <span class="co"># convert polygons to centroids</span></span>
<span id="cb3-8"><a href="methodology.html#cb3-8"></a>  pitches_osm<span class="op">$</span>osm_polygons <span class="op">%&gt;%</span></span>
<span id="cb3-9"><a href="methodology.html#cb3-9"></a><span class="st">    </span><span class="kw">st_transform</span>(this_crs) <span class="op">%&gt;%</span></span>
<span id="cb3-10"><a href="methodology.html#cb3-10"></a><span class="st">    </span><span class="kw">st_centroid</span>() <span class="op">%&gt;%</span></span>
<span id="cb3-11"><a href="methodology.html#cb3-11"></a><span class="st">    </span><span class="kw">select</span>(osm_id, sport),</span>
<span id="cb3-12"><a href="methodology.html#cb3-12"></a>  <span class="co"># get points</span></span>
<span id="cb3-13"><a href="methodology.html#cb3-13"></a>  pitches_osm<span class="op">$</span>osm_points <span class="op">%&gt;%</span></span>
<span id="cb3-14"><a href="methodology.html#cb3-14"></a><span class="st">    </span><span class="kw">st_transform</span>(this_crs) <span class="op">%&gt;%</span></span>
<span id="cb3-15"><a href="methodology.html#cb3-15"></a><span class="st">    </span><span class="kw">select</span>(osm_id, sport)</span>
<span id="cb3-16"><a href="methodology.html#cb3-16"></a>  <span class="co"># no multipolygons or polylines that need to be included</span></span>
<span id="cb3-17"><a href="methodology.html#cb3-17"></a>) <span class="op">%&gt;%</span></span>
<span id="cb3-18"><a href="methodology.html#cb3-18"></a><span class="st">  </span><span class="kw">filter</span>(sport <span class="op">!=</span><span class="st"> &quot;golf&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb3-19"><a href="methodology.html#cb3-19"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb3-20"><a href="methodology.html#cb3-20"></a>    <span class="dt">sport =</span> <span class="kw">case_when</span>(</span>
<span id="cb3-21"><a href="methodology.html#cb3-21"></a>      <span class="kw">grepl</span>(<span class="st">&quot;football&quot;</span>, sport) <span class="op">|</span><span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;soccer&quot;</span>, sport) <span class="op">~</span><span class="st"> &quot;football / soccer&quot;</span>,</span>
<span id="cb3-22"><a href="methodology.html#cb3-22"></a>      <span class="kw">grepl</span>(<span class="st">&quot;baseball&quot;</span>, sport) <span class="op">|</span><span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;softball&quot;</span>, sport) <span class="op">~</span><span class="st"> &quot;baseball&quot;</span>,</span>
<span id="cb3-23"><a href="methodology.html#cb3-23"></a>      <span class="kw">grepl</span>(<span class="st">&quot;basketball&quot;</span>, sport) <span class="op">~</span><span class="st"> &quot;basketball&quot;</span>,</span>
<span id="cb3-24"><a href="methodology.html#cb3-24"></a>      <span class="kw">grepl</span>(<span class="st">&quot;tennis&quot;</span>, sport) <span class="op">~</span><span class="st"> &quot;tennis&quot;</span>,</span>
<span id="cb3-25"><a href="methodology.html#cb3-25"></a>      <span class="kw">grepl</span>(<span class="st">&quot;volleyball&quot;</span>, sport) <span class="op">~</span><span class="st"> &quot;volleyball&quot;</span>,</span>
<span id="cb3-26"><a href="methodology.html#cb3-26"></a>      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;other&quot;</span></span>
<span id="cb3-27"><a href="methodology.html#cb3-27"></a>    )</span>
<span id="cb3-28"><a href="methodology.html#cb3-28"></a>  )</span></code></pre></div>
<pre><code>## Warning in st_centroid.sf(.): st_centroid assumes attributes are constant over
## geometries of x</code></pre>
<p>Finally, we identified trails and footpaths using the <code>path</code>, <code>cycleway</code>, and
<code>footway</code> values of the <code>highway</code> tag. A visual inspection of the resulting data
revealed that the large preponderance of sidewalks and cycling trails within parks
in Alameda County are identified properly with these variables.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="methodology.html#cb5-1"></a>trails_osm &lt;-<span class="st"> </span><span class="kw">opq</span>(bb) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># specify boundary for query</span></span>
<span id="cb5-2"><a href="methodology.html#cb5-2"></a><span class="st">  </span><span class="kw">add_osm_feature</span>(<span class="dt">key =</span> <span class="st">&quot;highway&quot;</span>, <span class="dt">value =</span> <span class="kw">c</span>(<span class="st">&quot;footway&quot;</span>, <span class="st">&quot;cycleway&quot;</span>, <span class="st">&quot;path&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb5-3"><a href="methodology.html#cb5-3"></a><span class="st">  </span><span class="kw">osmdata_sf</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb5-4"><a href="methodology.html#cb5-4"></a><span class="st">  </span><span class="kw">trim_osmdata</span>(bb, <span class="dt">exclude =</span> <span class="ot">FALSE</span>)</span>
<span id="cb5-5"><a href="methodology.html#cb5-5"></a></span>
<span id="cb5-6"><a href="methodology.html#cb5-6"></a>trails &lt;-<span class="st"> </span><span class="kw">rbind</span>(</span>
<span id="cb5-7"><a href="methodology.html#cb5-7"></a>  <span class="co"># points are nodes, so we can skip them.</span></span>
<span id="cb5-8"><a href="methodology.html#cb5-8"></a>  <span class="co"># lines</span></span>
<span id="cb5-9"><a href="methodology.html#cb5-9"></a>  trails_osm<span class="op">$</span>osm_lines <span class="op">%&gt;%</span></span>
<span id="cb5-10"><a href="methodology.html#cb5-10"></a><span class="st">    </span><span class="kw">st_transform</span>(this_crs) <span class="op">%&gt;%</span></span>
<span id="cb5-11"><a href="methodology.html#cb5-11"></a><span class="st">    </span><span class="kw">select</span>(osm_id, bicycle, foot, horse),</span>
<span id="cb5-12"><a href="methodology.html#cb5-12"></a>  </span>
<span id="cb5-13"><a href="methodology.html#cb5-13"></a>  <span class="co"># circular paths get converted to polygons, so we need to </span></span>
<span id="cb5-14"><a href="methodology.html#cb5-14"></a>  <span class="co"># turn them back into lines.</span></span>
<span id="cb5-15"><a href="methodology.html#cb5-15"></a>  trails_osm<span class="op">$</span>osm_polygons <span class="op">%&gt;%</span></span>
<span id="cb5-16"><a href="methodology.html#cb5-16"></a><span class="st">    </span><span class="kw">st_transform</span>(this_crs) <span class="op">%&gt;%</span></span>
<span id="cb5-17"><a href="methodology.html#cb5-17"></a><span class="st">    </span><span class="kw">st_boundary</span>() <span class="op">%&gt;%</span></span>
<span id="cb5-18"><a href="methodology.html#cb5-18"></a><span class="st">    </span><span class="kw">select</span>(osm_id, bicycle, foot, horse)</span>
<span id="cb5-19"><a href="methodology.html#cb5-19"></a>) <span class="op">%&gt;%</span></span>
<span id="cb5-20"><a href="methodology.html#cb5-20"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">length =</span> <span class="kw">st_length</span>(.))</span></code></pre></div>
<p>It is possible for each of these facilities to exist outside the context of
a public park. For example, many private apartment complexes have playgrounds
and high schools will have sports facilities that are not necessarily open to
the general public. We spatially matched the OSM amenities data and retained
only those facilities that intersected with the CPAD open spaces database
identified earlier.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="methodology.html#cb6-1"></a>attributed_parks &lt;-<span class="st"> </span>parks <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb6-2"><a href="methodology.html#cb6-2"></a><span class="st">  </span><span class="co"># determine if a playground point is inside the park polygon boundary</span></span>
<span id="cb6-3"><a href="methodology.html#cb6-3"></a><span class="st">  </span><span class="kw">st_join</span>(playgrounds <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(playground), st_intersects)  <span class="op">%&gt;%</span></span>
<span id="cb6-4"><a href="methodology.html#cb6-4"></a><span class="st">  </span><span class="co"># a park with multiple playgrounds will join multiple times, so we need to </span></span>
<span id="cb6-5"><a href="methodology.html#cb6-5"></a><span class="st">  </span><span class="co"># summarize them back down.</span></span>
<span id="cb6-6"><a href="methodology.html#cb6-6"></a><span class="st">  </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb6-7"><a href="methodology.html#cb6-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">playground =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(playground), F, playground)) <span class="op">%&gt;%</span></span>
<span id="cb6-8"><a href="methodology.html#cb6-8"></a><span class="st">  </span></span>
<span id="cb6-9"><a href="methodology.html#cb6-9"></a><span class="st">  </span><span class="co"># determine if the pitch points are inside the park polygon boundaries</span></span>
<span id="cb6-10"><a href="methodology.html#cb6-10"></a><span class="st">  </span><span class="kw">st_join</span>(pitches <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(sport)) <span class="op">%&gt;%</span></span>
<span id="cb6-11"><a href="methodology.html#cb6-11"></a><span class="st">  </span><span class="co"># multiple pitches in a park result in repeated rows. </span></span>
<span id="cb6-12"><a href="methodology.html#cb6-12"></a><span class="st">  </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb6-13"><a href="methodology.html#cb6-13"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pitch =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(sport), F, T)) <span class="op">%&gt;%</span></span>
<span id="cb6-14"><a href="methodology.html#cb6-14"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>sport) <span class="op">%&gt;%</span></span>
<span id="cb6-15"><a href="methodology.html#cb6-15"></a><span class="st">  </span></span>
<span id="cb6-16"><a href="methodology.html#cb6-16"></a><span class="st">  </span><span class="co"># determine if the trails are inside the park polygon boundaries</span></span>
<span id="cb6-17"><a href="methodology.html#cb6-17"></a><span class="st">  </span><span class="kw">st_join</span>(trails <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="dt">trail =</span> osm_id), st_intersects) <span class="op">%&gt;%</span></span>
<span id="cb6-18"><a href="methodology.html#cb6-18"></a><span class="st">  </span><span class="co"># multiple pitches in a park result in repeated rows. </span></span>
<span id="cb6-19"><a href="methodology.html#cb6-19"></a><span class="st">  </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb6-20"><a href="methodology.html#cb6-20"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">trail =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(trail), F, T))</span></code></pre></div>
<p>We provided the park boundaries layer to a commercial firm, StreetLight Data
Inc., which develops and resells origin-destination matrices derived from
passive device location data. The provider employs a proprietary data processing
engine (called Route Science) to algorithmically transform observed device
location data points (the provider uses in-vehicle GPS units and mobile device
LBS) over time into contextualized, normalized, and aggregated travel patterns.
From these travel patterns, the Route Science processing algorithms infer likely
home Census block group locations for composite groups of people and converts
raw location data points into trip origin and destination points <span class="citation">(Pan et al. <a href="#ref-Pan2006" role="doc-biblioref">2006</a>; Friedrich et al. <a href="#ref-Friedrich2010" role="doc-biblioref">2010</a>)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="methodology.html#cb7-1"></a>park_flows &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="kw">here</span>(<span class="st">&quot;data/Master_BlockGroups_Final071519.csv&quot;</span>), </span>
<span id="cb7-2"><a href="methodology.html#cb7-2"></a>                       <span class="dt">col_types =</span> <span class="kw">cols</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-3"><a href="methodology.html#cb7-3"></a><span class="st">  </span><span class="co"># need to make block group id properly formatted.</span></span>
<span id="cb7-4"><a href="methodology.html#cb7-4"></a><span class="st">  </span><span class="kw">transmute</span>(</span>
<span id="cb7-5"><a href="methodology.html#cb7-5"></a>    <span class="dt">park =</span> <span class="kw">as.character</span>(<span class="st">`</span><span class="dt">Zone Name</span><span class="st">`</span>),</span>
<span id="cb7-6"><a href="methodology.html#cb7-6"></a>    <span class="dt">home =</span> <span class="kw">paste0</span>(<span class="st">&quot;0&quot;</span>, <span class="kw">round</span>(<span class="st">`</span><span class="dt">Block Group ID</span><span class="st">`</span>)),</span>
<span id="cb7-7"><a href="methodology.html#cb7-7"></a>    <span class="dt">county =</span> <span class="kw">substr</span>(home, <span class="dv">0</span>, <span class="dv">5</span>),</span>
<span id="cb7-8"><a href="methodology.html#cb7-8"></a>    <span class="dt">attractions =</span> <span class="st">`</span><span class="dt">Zone Traffic (StL Index)</span><span class="st">`</span>,</span>
<span id="cb7-9"><a href="methodology.html#cb7-9"></a>    <span class="dt">d_share =</span> <span class="st">`</span><span class="dt">Percent by Home Location</span><span class="st">`</span></span>
<span id="cb7-10"><a href="methodology.html#cb7-10"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb7-11"><a href="methodology.html#cb7-11"></a><span class="st">  </span></span>
<span id="cb7-12"><a href="methodology.html#cb7-12"></a><span class="st">  </span><span class="co"># only keep bgs in the area</span></span>
<span id="cb7-13"><a href="methodology.html#cb7-13"></a><span class="st">  </span><span class="kw">filter</span>(county <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;06001&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb7-14"><a href="methodology.html#cb7-14"></a><span class="st">  </span><span class="co"># and only keep parks that we are looking at</span></span>
<span id="cb7-15"><a href="methodology.html#cb7-15"></a><span class="st">  </span><span class="kw">filter</span>(park <span class="op">%in%</span><span class="st"> </span>parks<span class="op">$</span>id) <span class="op">%&gt;%</span></span>
<span id="cb7-16"><a href="methodology.html#cb7-16"></a><span class="st">  </span></span>
<span id="cb7-17"><a href="methodology.html#cb7-17"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">flow =</span> attractions <span class="op">*</span><span class="st"> </span>d_share) <span class="op">%&gt;%</span></span>
<span id="cb7-18"><a href="methodology.html#cb7-18"></a><span class="st">  </span><span class="kw">group_by</span>(home) <span class="op">%&gt;%</span></span>
<span id="cb7-19"><a href="methodology.html#cb7-19"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb7-20"><a href="methodology.html#cb7-20"></a>    <span class="dt">productions =</span> <span class="kw">sum</span>(flow),</span>
<span id="cb7-21"><a href="methodology.html#cb7-21"></a>    <span class="dt">o_share =</span> flow <span class="op">/</span><span class="st"> </span>productions</span>
<span id="cb7-22"><a href="methodology.html#cb7-22"></a>  ) </span></code></pre></div>
<p>For each park polygon, the firm returned a population-weighted estimate of how
many devices were observed by home location block group over several months in
the period between May 2018 and October 2018. We transformed this table such
that it represented the weighted unique devices traveling between block groups
and parks. We discarded home location block groups outside of Alameda County;
the imputed home locations can be far away from the study area for a small
amount of trips and are unlikely to represent common or repeated park
activities.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="methodology.html#cb8-1"></a>attributed_parks &lt;-<span class="st"> </span>attributed_parks <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(type) <span class="op">%&gt;%</span></span>
<span id="cb8-2"><a href="methodology.html#cb8-2"></a><span class="st">  </span><span class="kw">left_join</span>(park_flows <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(park) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-3"><a href="methodology.html#cb8-3"></a><span class="st">              </span><span class="kw">select</span>(park, attractions), <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;id&quot;</span> =<span class="st"> &quot;park&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb8-4"><a href="methodology.html#cb8-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">attractions =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(attractions), <span class="dv">0</span>, attractions)) </span></code></pre></div>
<p>Table  presents descriptive statistics
on the 500 parks assembled for this study, grouped according to the
park type as defined on CPAD. A little more than half of the parks have
identified paths, while around 40% of the identified parks have playgrounds and
sport fields.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="methodology.html#cb9-1"></a>our_summary1 &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb9-2"><a href="methodology.html#cb9-2"></a>  <span class="st">&quot;Acres&quot;</span> =</span>
<span id="cb9-3"><a href="methodology.html#cb9-3"></a><span class="st">    </span><span class="kw">list</span>(<span class="st">&quot;min&quot;</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="kw">min</span>(.data<span class="op">$</span>acres),</span>
<span id="cb9-4"><a href="methodology.html#cb9-4"></a>         <span class="st">&quot;max&quot;</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="kw">max</span>(.data<span class="op">$</span>acres),</span>
<span id="cb9-5"><a href="methodology.html#cb9-5"></a>         <span class="st">&quot;mean (sd)&quot;</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span>qwraps2<span class="op">::</span><span class="kw">mean_sd</span>(.data<span class="op">$</span>acres)),</span>
<span id="cb9-6"><a href="methodology.html#cb9-6"></a>  <span class="st">&quot;Attributes&quot;</span> =</span>
<span id="cb9-7"><a href="methodology.html#cb9-7"></a><span class="st">    </span><span class="kw">list</span>(<span class="st">&quot;Has Playground&quot;</span> =<span class="st"> </span><span class="er">~</span>qwraps2<span class="op">::</span><span class="kw">n_perc0</span>(.data<span class="op">$</span>playground),</span>
<span id="cb9-8"><a href="methodology.html#cb9-8"></a>         <span class="st">&quot;Has Pitch / Court&quot;</span> =<span class="st"> </span><span class="er">~</span>qwraps2<span class="op">::</span><span class="kw">n_perc0</span>(.data<span class="op">$</span>pitch),</span>
<span id="cb9-9"><a href="methodology.html#cb9-9"></a>         <span class="st">&quot;Has Paths&quot;</span> =<span class="st">  </span><span class="er">~</span>qwraps2<span class="op">::</span><span class="kw">n_perc0</span>(.data<span class="op">$</span>trail)),</span>
<span id="cb9-10"><a href="methodology.html#cb9-10"></a>  <span class="st">&quot;Visitor Devices&quot;</span> =</span>
<span id="cb9-11"><a href="methodology.html#cb9-11"></a><span class="st">    </span><span class="kw">list</span>(<span class="st">&quot;min&quot;</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="kw">min</span>(.data<span class="op">$</span>attractions),</span>
<span id="cb9-12"><a href="methodology.html#cb9-12"></a>         <span class="st">&quot;max&quot;</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="kw">max</span>(.data<span class="op">$</span>attractions),</span>
<span id="cb9-13"><a href="methodology.html#cb9-13"></a>         <span class="st">&quot;mean (sd)&quot;</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span>qwraps2<span class="op">::</span><span class="kw">mean_sd</span>(.data<span class="op">$</span>attractions))</span>
<span id="cb9-14"><a href="methodology.html#cb9-14"></a>)</span>
<span id="cb9-15"><a href="methodology.html#cb9-15"></a></span>
<span id="cb9-16"><a href="methodology.html#cb9-16"></a>attributed_parks <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_set_geometry</span>(<span class="ot">NULL</span>) <span class="op">%&gt;%</span></span>
<span id="cb9-17"><a href="methodology.html#cb9-17"></a><span class="st">  </span><span class="kw">group_by</span>(type) <span class="op">%&gt;%</span></span>
<span id="cb9-18"><a href="methodology.html#cb9-18"></a><span class="st">  </span>qwraps2<span class="op">::</span><span class="kw">summary_table</span>(our_summary1) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-19"><a href="methodology.html#cb9-19"></a><span class="st">  </span><span class="kw">print</span>(<span class="dt">markup =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<colgroup>
<col width="23%" />
<col width="20%" />
<col width="28%" />
<col width="27%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">type: Local Park (N = 441)</th>
<th align="left">type: Local Recreation Area (N = 57)</th>
<th align="left">type: State Recreation Area (N = 2)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Acres</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   min</td>
<td align="left">0.038</td>
<td align="left">0.667</td>
<td align="left">228.958</td>
</tr>
<tr class="odd">
<td align="left">   max</td>
<td align="left">4939.817</td>
<td align="left">3851.412</td>
<td align="left">613.140</td>
</tr>
<tr class="even">
<td align="left">   mean (sd)</td>
<td align="left">59.81 <span class="math inline">\(\pm\)</span> 370.53</td>
<td align="left">115.20 <span class="math inline">\(\pm\)</span> 509.56</td>
<td align="left">421.05 <span class="math inline">\(\pm\)</span> 271.66</td>
</tr>
<tr class="odd">
<td align="left"><strong>Attributes</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   Has Playground</td>
<td align="left">212 (48)</td>
<td align="left">15 (26)</td>
<td align="left">0 (0)</td>
</tr>
<tr class="odd">
<td align="left">   Has Pitch / Court</td>
<td align="left">161 (37)</td>
<td align="left">20 (35)</td>
<td align="left">0 (0)</td>
</tr>
<tr class="even">
<td align="left">   Has Paths</td>
<td align="left">285 (65)</td>
<td align="left">35 (61)</td>
<td align="left">2 (100)</td>
</tr>
<tr class="odd">
<td align="left"><strong>Visitor Devices</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   min</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">   max</td>
<td align="left">108297</td>
<td align="left">29931</td>
<td align="left">161</td>
</tr>
<tr class="even">
<td align="left">   mean (sd)</td>
<td align="left">1,450.03 <span class="math inline">\(\pm\)</span> 6,685.41</td>
<td align="left">2,749.47 <span class="math inline">\(\pm\)</span> 6,250.42</td>
<td align="left">80.50 <span class="math inline">\(\pm\)</span> 113.84</td>
</tr>
</tbody>
</table>
<p>In order to understand the demographic makeup of the home block groups and
potentially the characteristics of the people who make each trip, we obtained
2013-2017 five-year data aggregations from the American Community Survey
using the <code>tidycensus</code> <span class="citation">(Walker <a href="#ref-Walker2019" role="doc-biblioref">2019</a>)</span> interface to the
Census API for several key demographic and built environment variables: the
share of individuals by ethnic group, the share of households by income level,
household median income, and the housing unit density. An important attribute of
the choice model is the distance from the home block group to the park boundary.
Because we have no information on where in the block group a home is actually
located, we use the population-weighted block group centroid published by the
Census Bureau as the location for all homes in the block group. We then measured
the Euclidean distance in miles between the block group and the boundary of each
park in the polygons layer.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="methodology.html#cb10-1"></a>variables &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb10-2"><a href="methodology.html#cb10-2"></a>  <span class="st">&quot;population&quot;</span> =<span class="st"> &quot;B25008_001&quot;</span>, <span class="co"># TOTAL POPULATION IN OCCUPIED HOUSING UNITS BY TENURE</span></span>
<span id="cb10-3"><a href="methodology.html#cb10-3"></a>  <span class="st">&quot;housing_units&quot;</span> =<span class="st"> &quot;B25001_001&quot;</span>, <span class="co"># HOUSING UNITS</span></span>
<span id="cb10-4"><a href="methodology.html#cb10-4"></a>  <span class="st">&quot;households&quot;</span> =<span class="st"> &quot;B19001_001&quot;</span>, <span class="co">#HOUSEHOLD INCOME IN THE PAST 12 MONTHS (IN 2017 INFLATION-ADJUSTED DOLLARS)</span></span>
<span id="cb10-5"><a href="methodology.html#cb10-5"></a>  <span class="co">#Estimate!!Total!!Female!!Worked in the past 12 months!!Usually worked 35 or more hours per week</span></span>
<span id="cb10-6"><a href="methodology.html#cb10-6"></a>  <span class="co"># RACE</span></span>
<span id="cb10-7"><a href="methodology.html#cb10-7"></a>  <span class="st">&quot;black&quot;</span> =<span class="st"> &quot;B02001_003&quot;</span>,</span>
<span id="cb10-8"><a href="methodology.html#cb10-8"></a>  <span class="st">&quot;asian&quot;</span> =<span class="st"> &quot;B02001_005&quot;</span>,</span>
<span id="cb10-9"><a href="methodology.html#cb10-9"></a>  <span class="st">&quot;pacific&quot;</span> =<span class="st"> &quot;B02001_006&quot;</span>,</span>
<span id="cb10-10"><a href="methodology.html#cb10-10"></a>  <span class="st">&quot;nativeam&quot;</span> =<span class="st"> &quot;B02001_004&quot;</span>,</span>
<span id="cb10-11"><a href="methodology.html#cb10-11"></a>  <span class="co"># HISPANIC OR LATINO ORIGIN BY SPECIFIC ORIGIN</span></span>
<span id="cb10-12"><a href="methodology.html#cb10-12"></a>  <span class="co"># The number of hispanic individuals needs to be drawn from a different table.</span></span>
<span id="cb10-13"><a href="methodology.html#cb10-13"></a>  <span class="st">&quot;hispanic&quot;</span> =<span class="st"> &quot;B03001_003&quot;</span>,</span>
<span id="cb10-14"><a href="methodology.html#cb10-14"></a>  <span class="co">#MEDIAN HOUSEHOLD INCOME IN THE PAST 12 MONTHS (IN 2017 INFLATION-ADJUSTED DOLLARS)</span></span>
<span id="cb10-15"><a href="methodology.html#cb10-15"></a>  <span class="st">&quot;income&quot;</span> =<span class="st"> &quot;B19013_001&quot;</span>,</span>
<span id="cb10-16"><a href="methodology.html#cb10-16"></a>  <span class="co">#HOUSEHOLD INCOME IN THE PAST 12 MONTHS (IN 2017 INFLATION-ADJUSTED DOLLARS)</span></span>
<span id="cb10-17"><a href="methodology.html#cb10-17"></a>  <span class="st">&quot;inc_0010&quot;</span> =<span class="st"> &quot;B19001_002&quot;</span>,  <span class="st">&quot;inc_1015&quot;</span> =<span class="st"> &quot;B19001_003&quot;</span>, <span class="st">&quot;inc_1520&quot;</span> =<span class="st"> &quot;B19001_004&quot;</span>,</span>
<span id="cb10-18"><a href="methodology.html#cb10-18"></a>  <span class="st">&quot;inc_2025&quot;</span> =<span class="st"> &quot;B19001_005&quot;</span>, <span class="st">&quot;inc_2530&quot;</span> =<span class="st"> &quot;B19001_006&quot;</span>, <span class="st">&quot;inc_3035&quot;</span> =<span class="st"> &quot;B19001_007&quot;</span>,</span>
<span id="cb10-19"><a href="methodology.html#cb10-19"></a>  <span class="st">&quot;inc_125&quot;</span>  =<span class="st"> &quot;B19001_015&quot;</span>, <span class="st">&quot;inc_150&quot;</span>  =<span class="st"> &quot;B19001_016&quot;</span>, <span class="st">&quot;inc_200&quot;</span>  =<span class="st"> &quot;B19001_017&quot;</span></span>
<span id="cb10-20"><a href="methodology.html#cb10-20"></a>)</span>
<span id="cb10-21"><a href="methodology.html#cb10-21"></a></span>
<span id="cb10-22"><a href="methodology.html#cb10-22"></a>acs &lt;-<span class="st"> </span><span class="kw">get_acs</span>(<span class="dt">geography =</span> <span class="st">&quot;block group&quot;</span>, <span class="dt">variables =</span> variables, <span class="dt">year =</span> <span class="dv">2017</span>,</span>
<span id="cb10-23"><a href="methodology.html#cb10-23"></a>               <span class="dt">state =</span> <span class="st">&quot;CA&quot;</span>, <span class="dt">county =</span> <span class="st">&quot;001&quot;</span>, <span class="dt">geometry =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb10-24"><a href="methodology.html#cb10-24"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>moe) <span class="op">%&gt;%</span></span>
<span id="cb10-25"><a href="methodology.html#cb10-25"></a><span class="st">  </span><span class="kw">spread</span>(variable, estimate) <span class="op">%&gt;%</span></span>
<span id="cb10-26"><a href="methodology.html#cb10-26"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">area =</span> <span class="kw">as.numeric</span>(<span class="kw">st_area</span>(geometry) <span class="op">*</span><span class="st"> </span><span class="fl">1e-6</span>)) <span class="op">%&gt;%</span></span>
<span id="cb10-27"><a href="methodology.html#cb10-27"></a><span class="st">  </span><span class="co"># area is in m^2, change to km^2</span></span>
<span id="cb10-28"><a href="methodology.html#cb10-28"></a><span class="st">  </span><span class="kw">transmute</span>(</span>
<span id="cb10-29"><a href="methodology.html#cb10-29"></a>    <span class="dt">geoid =</span> GEOID,</span>
<span id="cb10-30"><a href="methodology.html#cb10-30"></a>    population, households, housing_units, </span>
<span id="cb10-31"><a href="methodology.html#cb10-31"></a>    <span class="dt">density =</span> households <span class="op">/</span><span class="st"> </span>area,</span>
<span id="cb10-32"><a href="methodology.html#cb10-32"></a>    income,</span>
<span id="cb10-33"><a href="methodology.html#cb10-33"></a>    <span class="co"># many of the variables come in raw counts, but we want to consider</span></span>
<span id="cb10-34"><a href="methodology.html#cb10-34"></a>    <span class="co"># them as shares of a relevant denominator.</span></span>
<span id="cb10-35"><a href="methodology.html#cb10-35"></a>    <span class="dt">lowincome    =</span> <span class="dv">100</span> <span class="op">*</span><span class="st"> </span>(inc_<span class="dv">0010</span> <span class="op">+</span><span class="st"> </span>inc_<span class="dv">1015</span> <span class="op">+</span><span class="st"> </span>inc_<span class="dv">1520</span> <span class="op">+</span><span class="st"> </span>inc_<span class="dv">2530</span> <span class="op">+</span></span>
<span id="cb10-36"><a href="methodology.html#cb10-36"></a><span class="st">                            </span>inc_<span class="dv">3035</span>) <span class="op">/</span><span class="st"> </span>households,</span>
<span id="cb10-37"><a href="methodology.html#cb10-37"></a>    <span class="dt">highincome   =</span> <span class="dv">100</span> <span class="op">*</span><span class="st"> </span>(inc_<span class="dv">125</span> <span class="op">+</span><span class="st"> </span>inc_<span class="dv">150</span> <span class="op">+</span><span class="st"> </span>inc_<span class="dv">200</span>) <span class="op">/</span><span class="st"> </span>households,</span>
<span id="cb10-38"><a href="methodology.html#cb10-38"></a>    <span class="dt">black        =</span> <span class="dv">100</span> <span class="op">*</span><span class="st"> </span>black <span class="op">/</span><span class="st"> </span>population,</span>
<span id="cb10-39"><a href="methodology.html#cb10-39"></a>    <span class="dt">asian        =</span> <span class="dv">100</span> <span class="op">*</span><span class="st"> </span>asian <span class="op">/</span><span class="st"> </span>population,</span>
<span id="cb10-40"><a href="methodology.html#cb10-40"></a>    <span class="dt">other        =</span> <span class="dv">100</span> <span class="op">*</span><span class="st"> </span>(nativeam <span class="op">+</span><span class="st"> </span>pacific) <span class="op">/</span><span class="st"> </span>population,</span>
<span id="cb10-41"><a href="methodology.html#cb10-41"></a>    <span class="dt">white_hisp   =</span> <span class="dv">100</span> <span class="op">-</span><span class="st"> </span>black <span class="op">-</span><span class="st"> </span>asian <span class="op">-</span><span class="st"> </span>other</span>
<span id="cb10-42"><a href="methodology.html#cb10-42"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="methodology.html#cb11-1"></a>bg_centroids &lt;-<span class="st"> </span><span class="kw">read_csv</span>(</span>
<span id="cb11-2"><a href="methodology.html#cb11-2"></a>  <span class="st">&quot;https://www2.census.gov/geo/docs/reference/cenpop2010/blkgrp/CenPop2010_Mean_BG06.txt&quot;</span>,</span>
<span id="cb11-3"><a href="methodology.html#cb11-3"></a>  <span class="dt">col_types =</span> <span class="kw">list</span>(<span class="st">&quot;TRACTCE&quot;</span> =<span class="st"> </span><span class="kw">col_character</span>(), <span class="st">&quot;BLKGRPCE&quot;</span> =<span class="st"> </span><span class="kw">col_character</span>())</span>
<span id="cb11-4"><a href="methodology.html#cb11-4"></a>) <span class="op">%&gt;%</span></span>
<span id="cb11-5"><a href="methodology.html#cb11-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">GEOID =</span> <span class="kw">str_c</span>(STATEFP, COUNTYFP, TRACTCE, BLKGRPCE)) <span class="op">%&gt;%</span></span>
<span id="cb11-6"><a href="methodology.html#cb11-6"></a><span class="st">  </span><span class="kw">filter</span>(COUNTYFP <span class="op">%in%</span><span class="st"> &quot;001&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb11-7"><a href="methodology.html#cb11-7"></a><span class="st">  </span><span class="kw">st_as_sf</span>(<span class="dt">crs =</span> <span class="dv">4326</span>, <span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;LONGITUDE&quot;</span>, <span class="st">&quot;LATITUDE&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb11-8"><a href="methodology.html#cb11-8"></a><span class="st">  </span><span class="kw">st_transform</span>(this_crs)</span>
<span id="cb11-9"><a href="methodology.html#cb11-9"></a></span>
<span id="cb11-10"><a href="methodology.html#cb11-10"></a><span class="co"># distances from all tract centroids to all parks</span></span>
<span id="cb11-11"><a href="methodology.html#cb11-11"></a>distances &lt;-<span class="st"> </span><span class="kw">st_distance</span>(bg_centroids, parks, <span class="dt">byid =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb11-12"><a href="methodology.html#cb11-12"></a><span class="st">  </span>units<span class="op">::</span><span class="kw">set_units</span>(miles) <span class="op">%&gt;%</span></span>
<span id="cb11-13"><a href="methodology.html#cb11-13"></a><span class="st">  </span>units<span class="op">::</span><span class="kw">drop_units</span>()</span>
<span id="cb11-14"><a href="methodology.html#cb11-14"></a></span>
<span id="cb11-15"><a href="methodology.html#cb11-15"></a><span class="kw">rownames</span>(distances) &lt;-<span class="st"> </span>bg_centroids<span class="op">$</span>GEOID</span>
<span id="cb11-16"><a href="methodology.html#cb11-16"></a><span class="kw">colnames</span>(distances) &lt;-<span class="st"> </span>parks<span class="op">$</span>id</span>
<span id="cb11-17"><a href="methodology.html#cb11-17"></a></span>
<span id="cb11-18"><a href="methodology.html#cb11-18"></a>distance_df &lt;-<span class="st"> </span>distances <span class="op">%&gt;%</span></span>
<span id="cb11-19"><a href="methodology.html#cb11-19"></a><span class="st">  </span>omxr<span class="op">::</span><span class="kw">gather_matrix</span>(<span class="dt">value_name =</span> <span class="st">&quot;dist_euclid&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb11-20"><a href="methodology.html#cb11-20"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">home =</span> origin, <span class="dt">park =</span> destination)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="methodology.html#cb12-1"></a>tracts_data_index &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb12-2"><a href="methodology.html#cb12-2"></a>  <span class="dt">variable =</span>  <span class="kw">c</span>(<span class="st">&quot;density&quot;</span>, </span>
<span id="cb12-3"><a href="methodology.html#cb12-3"></a>    <span class="st">&quot;income&quot;</span>, <span class="st">&quot;lowincome&quot;</span>, <span class="st">&quot;highincome&quot;</span>,</span>
<span id="cb12-4"><a href="methodology.html#cb12-4"></a>    <span class="st">&quot;black&quot;</span>, <span class="st">&quot;asian&quot;</span>, <span class="st">&quot;other&quot;</span>)</span>
<span id="cb12-5"><a href="methodology.html#cb12-5"></a>) <span class="op">%&gt;%</span></span>
<span id="cb12-6"><a href="methodology.html#cb12-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">order =</span> <span class="kw">row_number</span>())</span>
<span id="cb12-7"><a href="methodology.html#cb12-7"></a>acs <span class="op">%&gt;%</span></span>
<span id="cb12-8"><a href="methodology.html#cb12-8"></a><span class="st">  </span><span class="kw">st_set_geometry</span>(<span class="ot">NULL</span>) <span class="op">%&gt;%</span></span>
<span id="cb12-9"><a href="methodology.html#cb12-9"></a><span class="st">  </span><span class="kw">filter</span>(population <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></span>
<span id="cb12-10"><a href="methodology.html#cb12-10"></a><span class="st">  </span><span class="kw">tbl_df</span>() <span class="op">%&gt;%</span></span>
<span id="cb12-11"><a href="methodology.html#cb12-11"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(tracts_data_index<span class="op">$</span>variable) <span class="op">%&gt;%</span></span>
<span id="cb12-12"><a href="methodology.html#cb12-12"></a><span class="st">  </span><span class="kw">gather</span>(variable, value) <span class="op">%&gt;%</span></span>
<span id="cb12-13"><a href="methodology.html#cb12-13"></a><span class="st">  </span><span class="kw">group_by</span>(variable) <span class="op">%&gt;%</span></span>
<span id="cb12-14"><a href="methodology.html#cb12-14"></a><span class="st">  </span><span class="kw">summarise</span>(</span>
<span id="cb12-15"><a href="methodology.html#cb12-15"></a>    <span class="st">`</span><span class="dt">msd</span><span class="st">`</span> =<span class="st"> </span><span class="kw">paste</span>(<span class="kw">median_iqr</span>(value, <span class="dt">na_rm =</span> <span class="ot">TRUE</span>, <span class="dt">show_n =</span> <span class="st">&quot;never&quot;</span>, <span class="dt">digits =</span> <span class="dv">1</span>))</span>
<span id="cb12-16"><a href="methodology.html#cb12-16"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb12-17"><a href="methodology.html#cb12-17"></a><span class="st">  </span><span class="kw">inner_join</span>(tracts_data_index, <span class="dt">by =</span> <span class="st">&quot;variable&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb12-18"><a href="methodology.html#cb12-18"></a><span class="st">  </span><span class="kw">arrange</span>(order) <span class="op">%&gt;%</span></span>
<span id="cb12-19"><a href="methodology.html#cb12-19"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb12-20"><a href="methodology.html#cb12-20"></a>    <span class="dt">variable =</span> <span class="kw">c</span>(</span>
<span id="cb12-21"><a href="methodology.html#cb12-21"></a>      <span class="st">&quot;Density: Households per square kilometer&quot;</span>,</span>
<span id="cb12-22"><a href="methodology.html#cb12-22"></a>      <span class="st">&quot;Income: Median tract income&quot;</span>,</span>
<span id="cb12-23"><a href="methodology.html#cb12-23"></a>      <span class="st">&quot;Low Income: Share of households making less than $35k&quot;</span>,</span>
<span id="cb12-24"><a href="methodology.html#cb12-24"></a>      <span class="st">&quot;High Income: Share of households making more than $125k&quot;</span>,</span>
<span id="cb12-25"><a href="methodology.html#cb12-25"></a>      <span class="st">&quot;Black: Share of population who is black&quot;</span>,</span>
<span id="cb12-26"><a href="methodology.html#cb12-26"></a>      <span class="st">&quot;Asian: Share of population who is Asian&quot;</span>,</span>
<span id="cb12-27"><a href="methodology.html#cb12-27"></a>      <span class="st">&quot;Other: Share of population who belong to other minority groups&quot;</span>)</span>
<span id="cb12-28"><a href="methodology.html#cb12-28"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb12-29"><a href="methodology.html#cb12-29"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>order) <span class="op">%&gt;%</span></span>
<span id="cb12-30"><a href="methodology.html#cb12-30"></a><span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;Median (IQR)&quot;</span>), <span class="dt">booktabs =</span> <span class="ot">TRUE</span>,</span>
<span id="cb12-31"><a href="methodology.html#cb12-31"></a>        <span class="dt">digits =</span> <span class="dv">1</span>,</span>
<span id="cb12-32"><a href="methodology.html#cb12-32"></a>        <span class="dt">caption =</span> <span class="st">&quot;Descriptive Statistics for Residence Block Groups&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: `tbl_df()` is deprecated as of dplyr 1.0.0.
## Please use `tibble::as_tibble()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<table>
<caption><span id="tab:acs-table">Table 3.1: </span>Descriptive Statistics for Residence Block Groups</caption>
<thead>
<tr class="header">
<th></th>
<th align="left">Median (IQR)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Density: Households per square kilometer</td>
<td align="left">1,352.9 (880.8, 2,187.0)</td>
</tr>
<tr class="even">
<td>Income: Median tract income</td>
<td align="left">85,673.0 (58,478.0, 119,375.0)</td>
</tr>
<tr class="odd">
<td>Low Income: Share of households making less than $35k</td>
<td align="left">15.1 (7.8, 26.1)</td>
</tr>
<tr class="even">
<td>High Income: Share of households making more than $125k</td>
<td align="left">30.4 (15.5, 46.5)</td>
</tr>
<tr class="odd">
<td>Black: Share of population who is black</td>
<td align="left">6.8 (1.8, 18.4)</td>
</tr>
<tr class="even">
<td>Asian: Share of population who is Asian</td>
<td align="left">21.1 (10.4, 37.8)</td>
</tr>
<tr class="odd">
<td>Other: Share of population who belong to other minority groups</td>
<td align="left">0.5 (0.0, 1.9)</td>
</tr>
</tbody>
</table>
</div>
<div id="model" class="section level2">
<h2><span class="header-section-number">3.2</span> Model</h2>
<p>In random utility choice theory, if an individual living in block group <span class="math inline">\(n\)</span>
wishes to make a park trip, the probability that the individual will choose
park <span class="math inline">\(i\)</span> from the set of all parks <span class="math inline">\(J\)</span> can be described as a ratio of the
park’s measurable utility <span class="math inline">\(V_{ni}\)</span> to the sum of the utilities for all parks
in the set. In the common destination choice framework we apply a
multinomial logit model <span class="citation">(McFadden <a href="#ref-McFadden1974" role="doc-biblioref">1974</a>, @Recker1978)</span>,
<span class="math display">\[\begin{equation}\label{eq:p}
   P_{ni} = \frac{\exp(V_{ni})}{\sum_{j \in J}\exp(V_{nj})}
\end{equation}\]</span>
where the measurable utility <span class="math inline">\(V_{ni}\)</span> is a linear-in-parameters function of
the destination attributes. If the park choice can be defined solely by
its size and the impedance in reaching the park from block group <span class="math inline">\(n\)</span>, then the
measurable utility would be
<span class="math display">\[\begin{equation}\label{eq:V}
V_{ni} = \beta_{1} * \mathit{size}_{i} + \beta_2 * \mathit{impedance}_{ni}
\end{equation}\]</span>
where <span class="math inline">\(\beta_1, \beta_2\)</span> are estimable coefficients giving the relative utility
(or disutility) of that attribute to the choice maker, all else equal. It is
possible to add additional amenities of the park or the journey to the utility
equation. However, as the number of alternatives is large, it is impractical to
consider alternative-specific constants or coefficients and therefore not
possible to include attributes of the home block group or traveler <span class="math inline">\(n\)</span> directly.
We can, however, segment the data and estimate different distance and size
parameters for different segments to observe heterogeneity in the utility
parameters between different socioeconomic groups.</p>
<p>The logarithm of the sum in the denominator of Equation  (called the
logsum) provides a measure of the consumer surplus of the choice set
<span class="citation">(Williams <a href="#ref-Williams1977a" role="doc-biblioref">1977</a>)</span>,
<span class="math display">\[\begin{equation}\label{eq:logsum}
CS_n = \ln{{\sum_{j \in J}\exp(V_{nj})}} + C
\end{equation}\]</span>
where <span class="math inline">\(C\)</span> is a constant indicating an unknown absolute value. But comparing the
relative logsum values across choice makers, <span class="math inline">\(CS_n - CS_{n-1}\)</span> gives an
indication of which choice maker has a more valuable choice set. Or, in this
case of a park destination choice model, which choice maker has better access to
parks. Such a “utility-based” accessibility term is thus continuously defined,
dervied directly from choice theory, and can contain multiple dimensions of the
attributes of the choice <span class="citation">(Handy and Niemeier <a href="#ref-Handy1997" role="doc-biblioref">1997</a>; Dong et al. <a href="#ref-Dong2006" role="doc-biblioref">2006</a>)</span>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="methodology.html#cb15-1"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb15-2"><a href="methodology.html#cb15-2"></a>n_obs &lt;-<span class="st"> </span><span class="dv">20000</span></span>
<span id="cb15-3"><a href="methodology.html#cb15-3"></a>n_alts &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb15-4"><a href="methodology.html#cb15-4"></a>n_flow &lt;-<span class="st"> </span><span class="kw">sum</span>(park_flows<span class="op">$</span>flow)</span>
<span id="cb15-5"><a href="methodology.html#cb15-5"></a>ll0e &lt;-<span class="st"> </span><span class="kw">sum</span>(n_obs <span class="op">*</span>.<span class="dv">8</span> <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">/</span>n_alts))</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="methodology.html#cb16-1"></a>mydata &lt;-<span class="st"> </span>park_flows <span class="op">%&gt;%</span></span>
<span id="cb16-2"><a href="methodology.html#cb16-2"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb16-3"><a href="methodology.html#cb16-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">weight =</span> flow <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(flow)) <span class="op">%&gt;%</span></span>
<span id="cb16-4"><a href="methodology.html#cb16-4"></a><span class="st">  </span><span class="kw">sample_n</span>(n_obs, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">weight =</span> weight) <span class="op">%&gt;%</span></span>
<span id="cb16-5"><a href="methodology.html#cb16-5"></a><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">id =</span> <span class="kw">row_number</span>(), home, <span class="dt">alt_0 =</span> park, </span>
<span id="cb16-6"><a href="methodology.html#cb16-6"></a>            <span class="dt">validation =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>), <span class="kw">n</span>(), <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>)))</span></code></pre></div>
<p>In the most typical cases, researchers estimate the utility coefficients for
destination choice models from household travel surveys. As we have no knowledge
of an appropriate survey on park access, we need to synthesize a suitable
estimation data set. We do this by sampling
210^{4} random discrete device origin-destination pairs from the commercial
passive data matrix, weighted by the volume of the flows. This corresponds to a
4.3% sample of all the observed device
origin-destination pairs.</p>
<p>The sampled origin-destination pair gives the home location as well as the
“chosen” alternative for a synthetic person. In principle the individual’s
choice set contains all the parks in our dataset; in practice it can be
difficult to estimate choice models with so many alternatives
(<span class="math inline">\(|J| = 500\)</span>). For this reason we randomly sample 10 additional parks
to serve as the non-chosen alternatives for our synthetic choice maker. Such
random sampling of alternatives reduces the efficiency of the estimated
coefficients but the coefficients remain unbiased <span class="citation">(Train <a href="#ref-train2009" role="doc-biblioref">2009</a>)</span>. As the model has
no alternative-specific constants, the standard likelihood comparison statistic
against the market shares model <span class="math inline">\(\rho^2\)</span> is not computable. We instead use the
likelihood comparison against the equal shares model <span class="math inline">\(\rho_0^2\)</span>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="methodology.html#cb17-1"></a>sampled_parks &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span>n_obs, <span class="cf">function</span>(i){</span>
<span id="cb17-2"><a href="methodology.html#cb17-2"></a>  <span class="kw">sample</span>(parks<span class="op">$</span>id, n_alts)</span>
<span id="cb17-3"><a href="methodology.html#cb17-3"></a>}) <span class="op">%&gt;%</span></span>
<span id="cb17-4"><a href="methodology.html#cb17-4"></a><span class="st">  </span><span class="kw">unlist</span>() <span class="op">%&gt;%</span></span>
<span id="cb17-5"><a href="methodology.html#cb17-5"></a><span class="st">  </span><span class="kw">matrix</span>(<span class="dt">ncol =</span> n_alts) <span class="op">%&gt;%</span></span>
<span id="cb17-6"><a href="methodology.html#cb17-6"></a><span class="st">  </span><span class="kw">as_tibble</span>(<span class="dt">.name_repair =</span> <span class="op">~</span><span class="st"> </span><span class="kw">str_c</span>(<span class="st">&quot;alt&quot;</span>, <span class="dv">1</span><span class="op">:</span>n_alts, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>))</span>
<span id="cb17-7"><a href="methodology.html#cb17-7"></a></span>
<span id="cb17-8"><a href="methodology.html#cb17-8"></a>logitdata &lt;-<span class="st"> </span>mydata <span class="op">%&gt;%</span></span>
<span id="cb17-9"><a href="methodology.html#cb17-9"></a><span class="st">  </span><span class="kw">bind_cols</span>(sampled_parks) <span class="op">%&gt;%</span></span>
<span id="cb17-10"><a href="methodology.html#cb17-10"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;alt&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;park&quot;</span>, <span class="op">-</span>id, <span class="op">-</span>home, <span class="op">-</span>validation) <span class="op">%&gt;%</span></span>
<span id="cb17-11"><a href="methodology.html#cb17-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">chosen =</span> alt <span class="op">==</span><span class="st"> &quot;alt_0&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb17-12"><a href="methodology.html#cb17-12"></a><span class="st">  </span><span class="kw">arrange</span>(id, alt) <span class="op">%&gt;%</span></span>
<span id="cb17-13"><a href="methodology.html#cb17-13"></a><span class="st">  </span></span>
<span id="cb17-14"><a href="methodology.html#cb17-14"></a><span class="st">  </span><span class="co"># append distances</span></span>
<span id="cb17-15"><a href="methodology.html#cb17-15"></a><span class="st">  </span><span class="kw">left_join</span>(distance_df, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;home&quot;</span>, <span class="st">&quot;park&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb17-16"><a href="methodology.html#cb17-16"></a><span class="st">  </span></span>
<span id="cb17-17"><a href="methodology.html#cb17-17"></a><span class="st">  </span><span class="co"># append park attributes</span></span>
<span id="cb17-18"><a href="methodology.html#cb17-18"></a><span class="st">  </span><span class="kw">left_join</span>(parks, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;park&quot;</span> =<span class="st"> &quot;id&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb17-19"><a href="methodology.html#cb17-19"></a><span class="st">  </span></span>
<span id="cb17-20"><a href="methodology.html#cb17-20"></a><span class="st">  </span><span class="co"># append block group attributes</span></span>
<span id="cb17-21"><a href="methodology.html#cb17-21"></a><span class="st">  </span><span class="kw">left_join</span>(acs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(geoid, density<span class="op">:</span>other) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_set_geometry</span>(<span class="ot">NULL</span>),</span>
<span id="cb17-22"><a href="methodology.html#cb17-22"></a>            <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;home&quot;</span> =<span class="st"> &quot;geoid&quot;</span>)</span>
<span id="cb17-23"><a href="methodology.html#cb17-23"></a>   </span>
<span id="cb17-24"><a href="methodology.html#cb17-24"></a>)</span></code></pre></div>
<p>The resulting analysis dataset therefore contains 210^{4} choice makers that
select between 11 parks including the park they were observed to
choose; the measured distance between the choice maker’s block group and all
parks in the choice set; and the acreage of each park in the choice set. We hold
out a random sample of approximately 20% of choice makers for validation
purposes. We use the <code>mlogit</code> package for R <span class="citation">(Croissant <a href="#ref-mlogit" role="doc-biblioref">2019</a>, <span class="citation">@R</span>)</span> to estimate the
multinomial logit models.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-mlogit">
<p>Croissant, Yves. 2019. <em>mlogit: Multinomial Logit Models</em>. <a href="https://cran.r-project.org/package=mlogit">https://cran.r-project.org/package=mlogit</a>.</p>
</div>
<div id="ref-Dong2006">
<p>Dong, Xiaojing, Moshe E. Ben-Akiva, John L. Bowman, and Joan L. Walker. 2006. “Moving from trip-based to activity-based measures of accessibility.” <em>Transportation Research Part A: Policy and Practice</em> 40 (2): 163–80. <a href="https://doi.org/10.1016/J.TRA.2005.05.002">https://doi.org/10.1016/J.TRA.2005.05.002</a>.</p>
</div>
<div id="ref-Friedrich2010">
<p>Friedrich, Markus, Katrin Immisch, Prokop Jehlicka, Thomas Otterstätter, and Johannes Schlaich. 2010. “Generating Origin-Destination Matrices from Mobile Phone Trajectories.” <em>Transportation Research Record: Journal of the Transportation Research Board</em> 2196: 93–101. <a href="https://doi.org/10.3141/2196-10">https://doi.org/10.3141/2196-10</a>.</p>
</div>
<div id="ref-cpad2019">
<p>GreenInfo Network. 2019. “California Protected Areas Database.” <a href="https://www.calands.org/cpad/">https://www.calands.org/cpad/</a>.</p>
</div>
<div id="ref-Handy1997">
<p>Handy, S L, and D A Niemeier. 1997. “Measuring Accessibility: An Exploration of Issues and Alternatives.” <em>Environment and Planning A</em> 29 (7): 1175–94. <a href="https://doi.org/10.1068/a291175">https://doi.org/10.1068/a291175</a>.</p>
</div>
<div id="ref-McFadden1974">
<p>McFadden, Daniel L. 1974. “Conditional Logit Analysis of Qualitative Choice Behavior.” In <em>Frontiers in Econometrics</em>, edited by Paul Zarembka, 105–42. New York: Academic Press.</p>
</div>
<div id="ref-osmdata">
<p>Padgham, Mark, Bob Rudis, Robin Lovelace, and Maëlle Salmon. 2017. “Osmdata.” <em>The Journal of Open Source Software</em> 2 (14). <a href="https://doi.org/10.21105/joss.00305">https://doi.org/10.21105/joss.00305</a>.</p>
</div>
<div id="ref-Pan2006">
<p>Pan, Changxuan, Jiangang Lu, Shan Di, and Bin Ran. 2006. “Cellular-Based Data-Extracting Method for Trip Distribution.” <em>Transportation Research Record: Journal of the Transportation Research Board</em> 1945 (1): 33–39. <a href="https://doi.org/10.1177/0361198106194500105">https://doi.org/10.1177/0361198106194500105</a>.</p>
</div>
<div id="ref-train2009">
<p>Train, Kenneth E. 2009. <em>Discrete Choice Methods with Simulation, 2nd Edition</em>. Cambridge: Cambridge University Press. <a href="https://doi.org/10.1016/S0898-1221(04)90100-9">https://doi.org/10.1016/S0898-1221(04)90100-9</a>.</p>
</div>
<div id="ref-alamedafacts">
<p>U.S. Census Bureau. 2019. “QuickFacts: Alameda County, California.” <a href="https://www.census.gov/quickfacts/fact/table/alamedacountycalifornia/PST045218">https://www.census.gov/quickfacts/fact/table/alamedacountycalifornia/PST045218</a>.</p>
</div>
<div id="ref-Walker2019">
<p>Walker, Kyle. 2019. <em>tidycensus: Load US Census Boundary and Attribute Data as ’tidyverse’ and ’sf’-Ready Data Frames</em>. <a href="https://cran.r-project.org/package=tidycensus">https://cran.r-project.org/package=tidycensus</a>.</p>
</div>
<div id="ref-Williams1977a">
<p>Williams, H C W L. 1977. “On the Formation of Travel Demand Models and Economic Evaluation Measures of User Benefit.” <em>Environment and Planning A: Economy and Space</em> 9 (3): 285–344. <a href="https://doi.org/10.1068/a090285">https://doi.org/10.1068/a090285</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="literature.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="applications.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["alameda_destinationchoice.pdf", "alameda_destinationchoice.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
